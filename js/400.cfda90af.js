"use strict";(self["webpackChunkerp"]=self["webpackChunkerp"]||[]).push([[400],{6400:function(e,t,i){i.r(t),i.d(t,{default:function(){return et}});var l=i(6252),a=i(3577);const s={class:"add-plant-model-wrapper"},o=(0,l._)("span",{class:"btn-back"},"返回",-1),d=(0,l._)("span",{class:"title"},"创建植物模型",-1),r={class:"content"},n={class:"section"},u={class:"section-title"},m=(0,l._)("div",{class:"left-view"},[(0,l.Uk)(" 植物生长模型 "),(0,l._)("span",{class:"tips"},"模型支持左右移动")],-1),c={class:"right-view"},g=(0,l.Uk)("添加"),h={class:"card-list"},w=["onClick"],p={class:"card-header"},v={class:"card-header-title"},f={class:"left-view"},_={class:"right-view"},G={class:"card-header-img"},F={class:"card-table"},k=(0,l._)("div",{class:"card-table-row"},[(0,l._)("div",{class:"left-view"},"参数名"),(0,l._)("div",{class:"right-view"},"参数值")],-1),b={class:"left-view"},L={class:"right-view"},C={class:"section"},W={class:"section-title"},y=(0,l._)("div",{class:"left-view"},[(0,l.Uk)(" 种植参考建议 "),(0,l._)("span",{class:"tips"},"模型支持上下移动")],-1),S={class:"right-view"},V=(0,l.Uk)("添加"),D={key:0,class:"icon-low"},x={key:1,class:"icon-high"},U={class:"btn"},I={class:"section"},P={class:"section-title"},M=(0,l._)("div",{class:"left-view"},"农事操作指导",-1),T={class:"right-view"},N=(0,l.Uk)("添加"),B={class:"guide-list"},$=["src"],E={class:"btns"},z={class:"title"},A={class:"desc-div"},K={class:"section"},Y={class:"section-title"},H=(0,l._)("div",{class:"left-view"},"病虫害防治",-1),j={class:"right-view"},q=(0,l.Uk)("添加"),R={class:"guide-list"},O=["src"],Q={class:"btns"},X={class:"title"},Z={class:"desc-div"},J={class:"footer"},ee=(0,l.Uk)("取消"),te=(0,l.Uk)("保存"),ie={class:"dialog-body"},le={class:"btn-upload"},ae=(0,l._)("div",null,"添加参考图",-1),se={class:"img-list"},oe={class:"standard-list"},de={class:"standard-item-content"},re=(0,l._)("div",{class:"label"},"参数名：",-1),ne={class:"standard-item-content"},ue=(0,l._)("div",{class:"label"},"参考值：",-1),me=(0,l._)("span",{class:"line"},"-",-1),ce={class:"standard-item-content"},ge={class:"dialog-footer"},he=(0,l.Uk)("取消"),we=(0,l.Uk)("保存"),pe={class:"dialog-content"},ve={class:"left-view"},fe=(0,l._)("div",{class:"right-view"},[(0,l._)("div",{class:"title"},[(0,l._)("span",{class:"title-item"},"阶段一：播种到萌芽")]),(0,l._)("div",{class:"desc"},"确定删除此生长阶段吗？")],-1),_e={class:"dialog-footer"},Ge=(0,l.Uk)("取消"),Fe=(0,l.Uk)("确认"),ke={class:"dialog-body"},be={class:"card-table"},Le=(0,l._)("div",{class:"card-table-row"},[(0,l._)("div",{class:"left-view"},"参数名"),(0,l._)("div",{class:"right-view"},"选择实际偏离")],-1),Ce={class:"left-view"},We={class:"right-view"},ye=(0,l._)("span",null,"偏低",-1),Se=(0,l._)("span",null,"正常",-1),Ve=(0,l._)("span",null,"偏高",-1),De={class:"dialog-footer"},xe=(0,l.Uk)("取消"),Ue=(0,l.Uk)("保存"),Ie={class:"dialog-body"},Pe={class:"btn-upload"},Me=(0,l.Uk)(" 点击上传视频 "),Te={class:"img-list"},Ne=["src"],Be={class:"dialog-footer"},$e=(0,l.Uk)("取消"),Ee=(0,l.Uk)("保存"),ze={class:"dialog-body"},Ae={class:"btn-upload"},Ke=(0,l.Uk)(" 点击上传视频 "),Ye={class:"img-list"},He=["src"],je={class:"dialog-footer"},qe=(0,l.Uk)("取消"),Re=(0,l.Uk)("保存");function Oe(e,t,i,Oe,Qe,Xe){const Ze=(0,l.up)("el-page-header"),Je=(0,l.up)("el-input"),et=(0,l.up)("el-form-item"),tt=(0,l.up)("el-option"),it=(0,l.up)("el-select"),lt=(0,l.up)("el-form"),at=(0,l.up)("el-button"),st=(0,l.up)("Edit"),ot=(0,l.up)("el-icon"),dt=(0,l.up)("Delete"),rt=(0,l.up)("el-image"),nt=(0,l.up)("el-table-column"),ut=(0,l.up)("el-table"),mt=(0,l.up)("Camera"),ct=(0,l.up)("el-upload"),gt=(0,l.up)("el-input-number"),ht=(0,l.up)("Plus"),wt=(0,l.up)("Minus"),pt=(0,l.up)("el-dialog"),vt=(0,l.up)("WarningFilled");return(0,l.wg)(),(0,l.iD)("div",s,[(0,l.Wm)(Ze,{onBack:Xe.goBack},{title:(0,l.w5)((()=>[o])),content:(0,l.w5)((()=>[d])),_:1},8,["onBack"]),(0,l._)("div",r,[(0,l.Wm)(lt,{ref:"form",inline:!0,model:Qe.form,rules:Qe.rules,class:"form"},{default:(0,l.w5)((()=>[(0,l.Wm)(et,{label:"种植类型",prop:"categoryTitle"},{default:(0,l.w5)((()=>[(0,l.Wm)(Je,{modelValue:Qe.form.categoryTitle,"onUpdate:modelValue":t[0]||(t[0]=e=>Qe.form.categoryTitle=e),placeholder:"请输入种植类型"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(et,{label:"种植品种",prop:"varietyTitle"},{default:(0,l.w5)((()=>[(0,l.Wm)(Je,{modelValue:Qe.form.varietyTitle,"onUpdate:modelValue":t[1]||(t[1]=e=>Qe.form.varietyTitle=e),placeholder:"请输入种植品种"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(et,{label:"培育方式",prop:"growthId"},{default:(0,l.w5)((()=>[(0,l.Wm)(it,{modelValue:Qe.form.growthId,"onUpdate:modelValue":t[2]||(t[2]=e=>Qe.form.growthId=e),placeholder:"请选择培育方式"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.growthTypeList,(e=>((0,l.wg)(),(0,l.j4)(tt,{label:e.title,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),(0,l._)("div",n,[(0,l._)("div",u,[m,(0,l._)("div",c,[(0,l.Wm)(at,{plain:"",type:"primary",icon:"CirclePlus",onClick:t[3]||(t[3]=e=>Xe.openAddGrowthStageDialog(null))},{default:(0,l.w5)((()=>[g])),_:1})])]),(0,l._)("div",h,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.growthStageList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,a.C_)(["card-item",{"card-item-active":t===Qe.selectedGrowthStageIndex}]),key:t,onClick:e=>Xe.selectGrowthStage(t)},[(0,l._)("div",p,[(0,l._)("div",v,[(0,l._)("div",f,"阶段"+(0,a.zw)(t+1)+"："+(0,a.zw)(e.phaseName),1),(0,l._)("div",_,[(0,l.Wm)(ot,{class:"icon",onClick:t=>Xe.openAddGrowthStageDialog(e,t)},{default:(0,l.w5)((()=>[(0,l.Wm)(st)])),_:2},1032,["onClick"]),(0,l.Wm)(ot,{class:"icon",onClick:e=>Xe.delGrowthStage(t,e)},{default:(0,l.w5)((()=>[(0,l.Wm)(dt)])),_:2},1032,["onClick"])])]),(0,l._)("div",G,[(0,l.Wm)(rt,{class:"img",src:e.image,fit:"cover"},null,8,["src"])])]),(0,l._)("div",F,[k,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.growPlantModelDetailBos,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"card-table-row",key:t},[(0,l._)("div",b,(0,a.zw)(e.parameterName),1),(0,l._)("div",L,(0,a.zw)(e.leastValue)+"-"+(0,a.zw)(e.maxValue)+(0,a.zw)(e.unit),1)])))),128))])],10,w)))),128))])]),(0,l._)("div",C,[(0,l._)("div",W,[y,(0,l._)("div",S,[(0,l.Wm)(at,{plain:"",type:"primary",icon:"CirclePlus",onClick:t[4]||(t[4]=e=>Xe.openPlantSuggestion(null))},{default:(0,l.w5)((()=>[V])),_:1})])]),(0,l.Wm)(ut,{class:"section-table",data:Xe.tableData,"max-height":"500","cell-class-name":Xe.getCellClassName},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.standardList,((e,t)=>((0,l.wg)(),(0,l.j4)(nt,{key:t,label:e.parameterName,width:"120"},{default:(0,l.w5)((t=>[(0,l._)("span",null,(0,a.zw)(Xe.getStatusText(t.row[e.parameterName])),1),0===t.row[e.parameterName]?((0,l.wg)(),(0,l.iD)("span",D)):(0,l.kq)("",!0),2===t.row[e.parameterName]?((0,l.wg)(),(0,l.iD)("span",x)):(0,l.kq)("",!0)])),_:2},1032,["label"])))),128)),(0,l.Wm)(nt,{label:"种植建议",prop:"text"}),(0,l.Wm)(nt,{label:"操作"},{default:(0,l.w5)((e=>[(0,l._)("div",U,[(0,l.Wm)(ot,{class:"icon",onClick:t=>Xe.openPlantSuggestion(e.row)},{default:(0,l.w5)((()=>[(0,l.Wm)(st)])),_:2},1032,["onClick"]),(0,l.Wm)(ot,{class:"icon",onClick:t=>Xe.delPlantSuggestion(e.$index)},{default:(0,l.w5)((()=>[(0,l.Wm)(dt)])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data","cell-class-name"])]),(0,l._)("div",I,[(0,l._)("div",P,[M,(0,l._)("div",T,[(0,l.Wm)(at,{plain:"",type:"primary",icon:"CirclePlus",onClick:t[5]||(t[5]=e=>Xe.openFarmGuideDialog(null))},{default:(0,l.w5)((()=>[N])),_:1})])]),(0,l._)("div",B,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.farmGuideList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"guide-item",key:t},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.imgList,(i=>((0,l.wg)(),(0,l.iD)("div",{class:"guide-item-img",key:i.url},[Xe.isVideo(i.url)?((0,l.wg)(),(0,l.iD)("video",{key:0,class:"video",src:i.url,controls:""},null,8,$)):((0,l.wg)(),(0,l.j4)(rt,{key:1,class:"img",src:i.url,fit:"cover"},null,8,["src"])),(0,l._)("div",E,[(0,l.Wm)(ot,{class:"icon",onClick:t=>Xe.openFarmGuideDialog(e)},{default:(0,l.w5)((()=>[(0,l.Wm)(st)])),_:2},1032,["onClick"]),(0,l.Wm)(ot,{class:"icon",onClick:e=>Xe.delFarmGuide(t)},{default:(0,l.w5)((()=>[(0,l.Wm)(dt)])),_:2},1032,["onClick"])])])))),128)),(0,l._)("div",z,(0,a.zw)(e.title),1),(0,l._)("div",A,(0,a.zw)(e.text),1)])))),128))])]),(0,l._)("div",K,[(0,l._)("div",Y,[H,(0,l._)("div",j,[(0,l.Wm)(at,{plain:"",type:"primary",icon:"CirclePlus",onClick:t[6]||(t[6]=e=>Xe.openCureGuideDialog(null))},{default:(0,l.w5)((()=>[q])),_:1})])]),(0,l._)("div",R,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.cureGuideList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"guide-item",key:t},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.imgList,(i=>((0,l.wg)(),(0,l.iD)("div",{class:"guide-item-img",key:i.url},[Xe.isVideo(i.url)?((0,l.wg)(),(0,l.iD)("video",{key:0,class:"video",src:i.url,controls:""},null,8,O)):((0,l.wg)(),(0,l.j4)(rt,{key:1,class:"img",src:i.url,fit:"cover"},null,8,["src"])),(0,l._)("div",Q,[(0,l.Wm)(ot,{class:"icon",onClick:t=>Xe.openCureGuideDialog(e)},{default:(0,l.w5)((()=>[(0,l.Wm)(st)])),_:2},1032,["onClick"]),(0,l.Wm)(ot,{class:"icon",onClick:e=>Xe.delCureGuide(t)},{default:(0,l.w5)((()=>[(0,l.Wm)(dt)])),_:2},1032,["onClick"])])])))),128)),(0,l._)("div",X,(0,a.zw)(e.title),1),(0,l._)("div",Z,(0,a.zw)(e.text),1)])))),128))])])]),(0,l._)("div",J,[(0,l.Wm)(at,{plain:"",onClick:Xe.goBack},{default:(0,l.w5)((()=>[ee])),_:1},8,["onClick"]),(0,l.Wm)(at,{class:"btn-save",type:"primary",onClick:Xe.savePlantModel},{default:(0,l.w5)((()=>[te])),_:1},8,["onClick"])]),(0,l.Wm)(pt,{modelValue:Qe.visibleForModel,"onUpdate:modelValue":t[9]||(t[9]=e=>Qe.visibleForModel=e),title:Qe.isEditForGrowthStage?"编辑生长阶段":"添加生长阶段",width:"50%","close-on-click-modal":!1,onClose:Xe.closeAddGrowthStageDialog},{footer:(0,l.w5)((()=>[(0,l._)("span",ge,[(0,l.Wm)(at,{onClick:Xe.closeAddGrowthStageDialog},{default:(0,l.w5)((()=>[he])),_:1},8,["onClick"]),(0,l.Wm)(at,{type:"primary",onClick:Xe.saveGrowthStage},{default:(0,l.w5)((()=>[we])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l._)("div",ie,[(0,l.Wm)(lt,{model:Qe.modelForm,"label-width":"80px","label-suffix":":"},{default:(0,l.w5)((()=>[(0,l.Wm)(et,{label:"阶段名称"},{default:(0,l.w5)((()=>[(0,l.Wm)(Je,{modelValue:Qe.modelForm.phaseName,"onUpdate:modelValue":t[7]||(t[7]=e=>Qe.modelForm.phaseName=e),clearable:"",placeholder:"请输入阶段名称",maxlength:64},null,8,["modelValue"])])),_:1}),(0,l.Wm)(et,{label:"参考图"},{default:(0,l.w5)((()=>[0===Qe.modelForm.imgList.length?((0,l.wg)(),(0,l.j4)(ct,{key:0,"file-list":Qe.modelForm.imgList,"onUpdate:file-list":t[8]||(t[8]=e=>Qe.modelForm.imgList=e),action:Qe.uploadUrl,"show-file-list":!1,limit:1},{default:(0,l.w5)((()=>[(0,l._)("div",le,[(0,l.Wm)(ot,null,{default:(0,l.w5)((()=>[(0,l.Wm)(mt)])),_:1}),ae])])),_:1},8,["file-list","action"])):(0,l.kq)("",!0),(0,l._)("div",se,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.modelForm.imgList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"img-item",key:t},[(0,l.Wm)(ot,{class:"icon",onClick:e=>Xe.delImgForGrowthStage(t)},{default:(0,l.w5)((()=>[(0,l.Wm)(dt)])),_:2},1032,["onClick"]),(0,l.Wm)(rt,{class:"img",src:e.response&&e.response.data&&e.response.data.imageUrl,fit:"cover"},null,8,["src"])])))),128))])])),_:1}),(0,l.Wm)(et,{label:"参考指标"}),(0,l._)("div",oe,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.modelForm.growPlantModelDetailBos,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"standard-item",key:t},[(0,l._)("div",de,[re,(0,l.Wm)(Je,{class:"input",modelValue:e.parameterName,"onUpdate:modelValue":t=>e.parameterName=t,readonly:0===t,placeholder:"请输入名称"},null,8,["modelValue","onUpdate:modelValue","readonly"])]),(0,l._)("div",ne,[ue,(0,l.Wm)(gt,{class:"input-number",modelValue:e.leastValue,"onUpdate:modelValue":t=>e.leastValue=t,min:0,controls:!1,placeholder:"最小值"},null,8,["modelValue","onUpdate:modelValue"]),me,(0,l.Wm)(gt,{class:"input-number",modelValue:e.maxValue,"onUpdate:modelValue":t=>e.maxValue=t,min:0,controls:!1,placeholder:"最大值"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.Wm)(Je,{class:"input-unit",modelValue:e.unit,"onUpdate:modelValue":t=>e.unit=t,placeholder:"输入单位"},null,8,["modelValue","onUpdate:modelValue"])]),(0,l._)("div",ce,[0===t?((0,l.wg)(),(0,l.j4)(ot,{key:0,class:"icon",onClick:Xe.addStandard},{default:(0,l.w5)((()=>[(0,l.Wm)(ht)])),_:1},8,["onClick"])):(0,l.kq)("",!0),0!==t?((0,l.wg)(),(0,l.j4)(ot,{key:1,class:"icon",onClick:e=>Xe.delStandard(t)},{default:(0,l.w5)((()=>[(0,l.Wm)(wt)])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])])))),128))])])),_:1},8,["model"])])])),_:1},8,["modelValue","title","onClose"]),(0,l.Wm)(pt,{modelValue:Qe.visibleForDelModel,"onUpdate:modelValue":t[11]||(t[11]=e=>Qe.visibleForDelModel=e),title:"删除生长阶段",width:"40%","close-on-click-modal":!1},{footer:(0,l.w5)((()=>[(0,l._)("span",_e,[(0,l.Wm)(at,{onClick:t[10]||(t[10]=e=>Qe.visibleForDelModel=!1)},{default:(0,l.w5)((()=>[Ge])),_:1}),(0,l.Wm)(at,{type:"primary",onClick:e.confirm},{default:(0,l.w5)((()=>[Fe])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l._)("div",pe,[(0,l._)("div",ve,[(0,l.Wm)(ot,null,{default:(0,l.w5)((()=>[(0,l.Wm)(vt)])),_:1})]),fe])])),_:1},8,["modelValue"]),(0,l.Wm)(pt,{modelValue:Qe.visibleForSuggestion,"onUpdate:modelValue":t[13]||(t[13]=e=>Qe.visibleForSuggestion=e),"close-on-click-modal":!1,title:Qe.isEditForSuggestion?"编辑种植建议":"添加种植建议",width:"30%"},{footer:(0,l.w5)((()=>[(0,l._)("span",De,[(0,l.Wm)(at,{onClick:Xe.closePlantSuggestion},{default:(0,l.w5)((()=>[xe])),_:1},8,["onClick"]),(0,l.Wm)(at,{type:"primary",onClick:Xe.savePlantSuggestion},{default:(0,l.w5)((()=>[Ue])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l._)("div",ke,[(0,l._)("div",be,[Le,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.standardList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"card-table-row",key:t},[(0,l._)("div",Ce,(0,a.zw)(e.parameterName),1),(0,l._)("div",We,[(0,l.Wm)(it,{class:"select",modelValue:e.status,"onUpdate:modelValue":t=>e.status=t,placeholder:"请选择"},{default:(0,l.w5)((()=>[(0,l.Wm)(tt,{class:"low",label:"偏低",value:0},{default:(0,l.w5)((()=>[ye])),_:1}),(0,l.Wm)(tt,{class:"normal",label:"正常",value:1},{default:(0,l.w5)((()=>[Se])),_:1}),(0,l.Wm)(tt,{class:"high",label:"偏高",value:2},{default:(0,l.w5)((()=>[Ve])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])])))),128))]),(0,l.Wm)(lt,{model:Qe.suggestionForm,"label-width":"100px","label-position":"top","label-suffix":":"},{default:(0,l.w5)((()=>[(0,l.Wm)(et,{label:"种植建议"},{default:(0,l.w5)((()=>[(0,l.Wm)(Je,{modelValue:Qe.suggestionForm.suggestion,"onUpdate:modelValue":t[12]||(t[12]=e=>Qe.suggestionForm.suggestion=e),clearable:"",autosize:{minRows:3,maxRows:5},placeholder:"*种植建议中的关键词，可作为农事操作指导和病虫害防治的内容标签",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue","title"]),(0,l.Wm)(pt,{modelValue:Qe.visibleForFarmGuide,"onUpdate:modelValue":t[17]||(t[17]=e=>Qe.visibleForFarmGuide=e),title:Qe.isEditForFarmGuide?"编辑农事指导":"添加农事指导",width:"35%","close-on-click-modal":!1,onClose:Xe.closeFarmGuideDialog},{footer:(0,l.w5)((()=>[(0,l._)("span",Be,[(0,l.Wm)(at,{onClick:Xe.closeFarmGuideDialog},{default:(0,l.w5)((()=>[$e])),_:1},8,["onClick"]),(0,l.Wm)(at,{type:"primary",onClick:Xe.saveFarmGuide},{default:(0,l.w5)((()=>[Ee])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l._)("div",Ie,[(0,l.Wm)(lt,{model:Qe.farmGuideForm,"label-width":"100px","label-suffix":":"},{default:(0,l.w5)((()=>[(0,l.Wm)(et,{label:"参考视频"},{default:(0,l.w5)((()=>[0===Qe.farmGuideForm.imgList.length?((0,l.wg)(),(0,l.j4)(ct,{key:0,"file-list":Qe.farmGuideForm.imgList,"onUpdate:file-list":t[14]||(t[14]=e=>Qe.farmGuideForm.imgList=e),action:Qe.uploadUrl,"show-file-list":!1,limit:1},{default:(0,l.w5)((()=>[(0,l._)("div",Pe,[(0,l.Wm)(ot,null,{default:(0,l.w5)((()=>[(0,l.Wm)(mt)])),_:1}),Me])])),_:1},8,["file-list","action"])):(0,l.kq)("",!0),(0,l._)("div",Te,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.farmGuideForm.imgList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"img-item",key:t},[(0,l.Wm)(ot,{class:"icon",onClick:e=>Xe.delImgForFarmGuide(t)},{default:(0,l.w5)((()=>[(0,l.Wm)(dt)])),_:2},1032,["onClick"]),(0,l._)("video",{class:"video",src:e.response&&e.response.data&&e.response.data.imageUrl,controls:""},null,8,Ne)])))),128))])])),_:1}),(0,l.Wm)(et,{label:"标题"},{default:(0,l.w5)((()=>[(0,l.Wm)(Je,{modelValue:Qe.farmGuideForm.title,"onUpdate:modelValue":t[15]||(t[15]=e=>Qe.farmGuideForm.title=e),clearable:"",placeholder:"请输入指导标题"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(et,{label:"内容标签"},{default:(0,l.w5)((()=>[(0,l.Wm)(Je,{modelValue:Qe.farmGuideForm.text,"onUpdate:modelValue":t[16]||(t[16]=e=>Qe.farmGuideForm.text=e),clearable:"",autosize:{minRows:3,maxRows:5},placeholder:"如：#增加光照",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue","title","onClose"]),(0,l.Wm)(pt,{modelValue:Qe.visibleForCureGuide,"onUpdate:modelValue":t[21]||(t[21]=e=>Qe.visibleForCureGuide=e),title:Qe.isEditForCureGuide?"编辑病虫害防治指导":"添加病虫害防治指导",width:"35%","close-on-click-modal":!1,onClose:Xe.closeCureGuideDialog},{footer:(0,l.w5)((()=>[(0,l._)("span",je,[(0,l.Wm)(at,{onClick:Xe.closeCureGuideDialog},{default:(0,l.w5)((()=>[qe])),_:1},8,["onClick"]),(0,l.Wm)(at,{type:"primary",onClick:Xe.saveCureGuide},{default:(0,l.w5)((()=>[Re])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l._)("div",ze,[(0,l.Wm)(lt,{model:Qe.cureGuideForm,"label-width":"100px","label-suffix":":"},{default:(0,l.w5)((()=>[(0,l.Wm)(et,{label:"参考视频"},{default:(0,l.w5)((()=>[0===Qe.cureGuideForm.imgList.length?((0,l.wg)(),(0,l.j4)(ct,{key:0,"file-list":Qe.cureGuideForm.imgList,"onUpdate:file-list":t[18]||(t[18]=e=>Qe.cureGuideForm.imgList=e),action:Qe.uploadUrl,"show-file-list":!1,limit:1},{default:(0,l.w5)((()=>[(0,l._)("div",Ae,[(0,l.Wm)(ot,null,{default:(0,l.w5)((()=>[(0,l.Wm)(mt)])),_:1}),Ke])])),_:1},8,["file-list","action"])):(0,l.kq)("",!0),(0,l._)("div",Ye,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Qe.cureGuideForm.imgList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"img-item",key:t},[(0,l.Wm)(ot,{class:"icon",onClick:e=>Xe.delImgForCureGuide(t)},{default:(0,l.w5)((()=>[(0,l.Wm)(dt)])),_:2},1032,["onClick"]),(0,l._)("video",{class:"video",src:e.response&&e.response.data&&e.response.data.imageUrl,controls:""},null,8,He)])))),128))])])),_:1}),(0,l.Wm)(et,{label:"标题"},{default:(0,l.w5)((()=>[(0,l.Wm)(Je,{modelValue:Qe.cureGuideForm.title,"onUpdate:modelValue":t[19]||(t[19]=e=>Qe.cureGuideForm.title=e),clearable:"",placeholder:"请输入指导标题"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(et,{label:"内容标签"},{default:(0,l.w5)((()=>[(0,l.Wm)(Je,{modelValue:Qe.cureGuideForm.text,"onUpdate:modelValue":t[20]||(t[20]=e=>Qe.cureGuideForm.text=e),clearable:"",autosize:{minRows:3,maxRows:5},placeholder:"如：#增加光照",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue","title","onClose"])])}var Qe=i(512),Xe={name:"Add",data(){return{plantModelId:"",uploadUrl:Qe.P_,growthTypeList:[],form:{categoryTitle:"",varietyTitle:"",growthId:""},growthStageList:[],selectedGrowthStageIndex:-1,standardList:[],tableList:[],isEditForGrowthStage:!1,modelForm:{id:0,phaseName:"",imgList:[],growPlantModelDetailBos:[{parameterName:"种植天数",leastValue:void 0,maxValue:void 0,unit:""}]},visibleForModel:!1,visibleForDelModel:!1,visibleForSuggestion:!1,isEditForSuggestion:!1,suggestionForm:{suggestion:""},visibleForFarmGuide:!1,isEditForFarmGuide:!1,farmGuideForm:{id:0,imgList:[],title:"",text:""},farmGuideList:[],visibleForCureGuide:!1,isEditForCureGuide:!1,cureGuideForm:{id:0,imgList:[],title:"",text:""},cureGuideList:[],rules:{categoryTitle:[{required:!0,message:"请输入种植类型",trigger:"blur"}],varietyTitle:[{required:!0,message:"请输入种植品种",trigger:"blur"}],growthId:[{required:!0,message:"请选择培育方式",trigger:"change"}]}}},computed:{tableData(){let e=[];return this.tableList.forEach((t=>{t.growPlantAdviseDetailBos&&t.growPlantAdviseDetailBos.forEach((e=>{t[e.parameterName]=e.status})),e.push(t)})),e}},mounted(){this.plantModelId=this.$route.query.id,this.getGrowthTypeList(),this.plantModelId&&(this.getPlantModelDetail(),this.getGrowthStageList().then((()=>{this.growthStageList.length>0&&(this.selectedGrowthStageIndex=0,this.getStandardList(),this.getPlantSuggestionList())})),this.getFarmGuideList(),this.getCureGuideList())},methods:{getGrowthTypeList(){const e={};(0,Qe.Ne)(e).then((e=>{e&&e.data&&(this.growthTypeList=e.data)}))},goBack(){this.$router.back()},getPlantModelDetail(){const e={id:this.plantModelId};return(0,Qe.oQ)(e).then((e=>{e&&e.data&&(this.form={categoryTitle:e.data.categoryTitle,varietyTitle:e.data.varietyTitle,growthId:e.data.growthId})}))},getGrowthStageList(){const e={id:this.plantModelId};return(0,Qe.bA)(e).then((e=>{e&&e.data&&(this.growthStageList=e.data)}))},getPlantSuggestionList(){if(0===this.growthStageList.length)return void console.log("生长阶段列表为空");if(-1===this.selectedGrowthStageIndex)return void console.log("请先选择生长阶段");const e={id:this.plantModelId,growPlantId:this.growthStageList[this.selectedGrowthStageIndex].id};return(0,Qe.FK)(e).then((e=>{e&&e.data&&(this.tableList=e.data)}))},getFarmGuideList(){const e={id:this.plantModelId};return(0,Qe.Ly)(e).then((e=>{e&&e.data&&(this.farmGuideList=e.data.map((e=>(e.imgList=[{url:e.video,response:{data:{imageUrl:e.video}}}],e))))}))},getCureGuideList(){const e={id:this.plantModelId};return(0,Qe.w7)(e).then((e=>{e&&e.data&&(this.cureGuideList=e.data.map((e=>(e.imgList=[{url:e.video,response:{data:{imageUrl:e.video}}}],e))))}))},selectGrowthStage(e){this.tableList=[],this.selectedGrowthStageIndex=e,this.getStandardList(),this.getPlantSuggestionList()},openAddGrowthStageDialog(e,t){t&&t.stopPropagation(),e&&(this.isEditForGrowthStage=!0,this.modelForm={id:e.id,phaseName:e.phaseName,imgList:[{url:e.image,response:{data:{imageUrl:e.image}}}],growPlantModelDetailBos:e.growPlantModelDetailBos.map((e=>({...e})))}),this.visibleForModel=!0},closeAddGrowthStageDialog(){this.visibleForModel=!1,this.isEditForGrowthStage=!1,this.modelForm={id:0,phaseName:"",imgList:[],growPlantModelDetailBos:[{parameterName:"种植天数",leastValue:void 0,maxValue:void 0,unit:""}]}},delGrowthStage(e,t){t.stopPropagation(),this.$confirm("确认删除此生长阶段吗？","删除生长阶段",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{this.growthStageList.splice(e,1)})).catch((()=>{console.log("取消")}))},addStandard(){this.modelForm.growPlantModelDetailBos.push({name:"",min:void 0,max:void 0,unit:""})},delStandard(e){this.modelForm.growPlantModelDetailBos.splice(e,1)},delImgForGrowthStage(e){this.modelForm.imgList.splice(e,1)},saveGrowthStage(){if(this.modelForm.growPlantModelDetailBos.some((e=>!e.parameterName||!e.leastValue||!e.maxValue||!e.unit)))return void this.$message.warning("请填写完整的参考指标(参数名、最大/小值、单位)！");const e={createName:"",growModelId:this.plantModelId,growPlantModelDetailBos:this.modelForm.growPlantModelDetailBos,id:this.modelForm.id,image:"",phaseName:this.modelForm.phaseName};if(this.modelForm.imgList[0]){const t=this.modelForm.imgList[0].response;e.image=t&&t.data&&t.data.imageUrl}return(0,Qe.lb)(e).then((e=>{if(e&&"200"===e.code){this.$message.success("保存成功");const t=this.growthStageList.findIndex((t=>t.id===e.data.id));-1!==t?this.growthStageList.splice(t,1,e.data):this.growthStageList.push(e.data),this.closeAddGrowthStageDialog()}else this.$message.error(e.message||"保存失败")}))},getStandardList(){if(0===this.growthStageList.length)return;if(-1===this.selectedGrowthStageIndex)return void console.log("请选择生长阶段");const e={growPlantId:this.growthStageList[this.selectedGrowthStageIndex].id};return(0,Qe.nX)(e).then((e=>{e&&e.data?this.standardList=e.data.map((e=>({parameterName:e.title,status:1}))):this.$message.error(e.message||"获取参数列表失败")}))},openPlantSuggestion(e){0!==this.growthStageList.length?-1!==this.selectedGrowthStageIndex?this.getStandardList().then((()=>{e&&(this.isEditForSuggestion=!0,this.suggestionForm={id:e.id,suggestion:e.text},this.standardList=e.growPlantAdviseDetailBos),this.visibleForSuggestion=!0})):this.$message.warning("请选择生长阶段"):this.$message.warning("请先添加生长阶段")},closePlantSuggestion(){this.visibleForSuggestion=!1,this.isEditForSuggestion=!1,this.suggestionForm={suggestion:""}},delPlantSuggestion(e){this.$confirm("确认删除该条种植建议吗？","删除种植建议",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{this.tableList.splice(e,1)})).catch((()=>{console.log("取消")}))},savePlantSuggestion(){const e={createName:"",growModelId:this.plantModelId,growPlantModelId:this.growthStageList[this.selectedGrowthStageIndex].id,growPlantAdviseDetailBos:this.standardList,id:this.suggestionForm.id,text:this.suggestionForm.suggestion};return(0,Qe.oY)(e).then((e=>{if(e&&"200"===e.code){this.$message.success("保存成功");const t=this.tableList.findIndex((e=>e.id===this.suggestionForm.id));-1===t?this.tableList.push(e.data):this.tableList.splice(t,1,e.data),this.closePlantSuggestion()}else this.$message.error(e.message||"保存失败")}))},openFarmGuideDialog(e){e&&(this.isEditForFarmGuide=!0,this.farmGuideForm={...e}),this.visibleForFarmGuide=!0},closeFarmGuideDialog(){this.visibleForFarmGuide=!1,this.isEditForFarmGuide=!1,this.farmGuideForm={id:0,imgList:[],title:"",text:""}},delFarmGuide(e){this.$confirm("确认删除该农事指导吗？","删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{this.farmGuideList.splice(e,1)})).catch((()=>{console.log("取消")}))},delImgForFarmGuide(e){this.farmGuideForm.imgList.splice(e,1)},saveFarmGuide(){const e={growModelId:this.plantModelId,id:this.farmGuideForm.id,text:this.farmGuideForm.text,title:this.farmGuideForm.title,video:""};if(this.farmGuideForm.imgList[0]){const t=this.farmGuideForm.imgList[0].response;e.video=t&&t.data&&t.data.imageUrl}return(0,Qe._h)(e).then((e=>{if(e&&"200"===e.code){this.$message.success("保存成功");const t=this.farmGuideList.findIndex((e=>e.id===this.farmGuideForm.id)),i={...e.data,imgList:[{url:e.data.video,response:{data:{imageUrl:e.data.video}}}]};-1===t?this.farmGuideList.push(i):this.farmGuideList.splice(t,1,i),this.closeFarmGuideDialog()}else this.$message.error(e.message||"保存失败")}))},openCureGuideDialog(e){e&&(this.isEditForCureGuide=!0,this.cureGuideForm={...e}),this.visibleForCureGuide=!0},closeCureGuideDialog(){this.visibleForCureGuide=!1,this.isEditForCureGuide=!1,this.cureGuideForm={id:0,imgList:[],title:"",text:""}},saveCureGuide(){const e={growModelId:this.plantModelId,id:this.cureGuideForm.id,text:this.cureGuideForm.text,title:this.cureGuideForm.title,video:""};if(this.cureGuideForm.imgList[0]){const t=this.cureGuideForm.imgList[0].response;e.video=t&&t.data&&t.data.imageUrl}return(0,Qe.q4)(e).then((e=>{if(e&&"200"===e.code){this.$message.success("保存成功");const t=this.cureGuideList.findIndex((e=>e.id===this.cureGuideForm.id)),i={...e.data,imgList:[{url:e.data.video,response:{data:{imageUrl:e.data.video}}}]};-1===t?this.cureGuideList.push(i):this.cureGuideList.splice(t,1,i),this.closeCureGuideDialog()}else this.$message.error(e.message||"保存失败")}))},delCureGuide(e){this.$confirm("确认删除该防治病虫害指导吗？","删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{this.cureGuideList.splice(e,1)})).catch((()=>{console.log("取消")}))},delImgForCureGuide(e){this.cureGuideForm.imgList.splice(e,1)},savePlantModel(){this.$refs.form.validate((e=>{if(e){const e={categoryTitle:this.form.categoryTitle,growAdviseIds:"",growModelIds:"",growOperationGuideIds:"",growPreventionGuideIds:"",growthId:this.form.growthId,growthName:"",id:this.plantModelId,varietyTitle:this.form.varietyTitle},t=this.growthTypeList.find((e=>e.id===this.form.growthId));return e.growthName=t&&t.title,this.growthStageList.length>0&&(e.growModelIds=this.growthStageList.map((e=>e.id)).join(",")),this.farmGuideList.length>0&&(e.growOperationGuideIds=this.farmGuideList.map((e=>e.id)).join(",")),this.cureGuideList.length>0&&(e.growPreventionGuideIds=this.cureGuideList.map((e=>e.id)).join(",")),(0,Qe.lF)(e).then((e=>{e&&"200"===e.code?(this.$message.success("保存成功"),this.$router.back()):this.$message.error(e.message||"保存失败")}))}}))},getStatusText(e){const t=[{label:"偏低",value:0},{label:"正常",value:1},{label:"偏高",value:2}],i=t.find((t=>t.value===e));return i?i.label:e},getCellClassName({row:e,column:t}){const i=t.label,l=e[i],a={0:"cell-low",1:"cell-normal",2:"cell-high"};return a[l]||""},isVideo(e){const t=/.(mp4|MP4|3gp|3GP)$/;return t.test(e)}}},Ze=i(3744);const Je=(0,Ze.Z)(Xe,[["render",Oe]]);var et=Je}}]);
//# sourceMappingURL=400.cfda90af.js.map