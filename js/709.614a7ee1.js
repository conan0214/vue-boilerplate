"use strict";(self["webpackChunkerp"]=self["webpackChunkerp"]||[]).push([[709],{2709:function(e,l,a){a.r(l),a.d(l,{default:function(){return Re}});var t=a(6252),i=a(3577);const r=e=>((0,t.dD)("data-v-913300be"),e=e(),(0,t.Cn)(),e),s={class:"index-wrapper"},d={class:"search-wrapper"},o={class:"search-item"},u=r((()=>(0,t._)("div",{class:"search-item-lable"},"跟进状态",-1))),c=(0,t.Uk)("搜索"),n={class:"search-item"},m=r((()=>(0,t._)("div",{class:"search-item-lable"},"状态",-1))),h=(0,t.Uk)("搜索"),g=(0,t.Uk)("新建农资"),p={class:"type"},w={class:"name"},v={class:"count"},b=(0,t.Uk)("查看详情"),f=(0,t.Uk)("跟进"),_=(0,t.Uk)("完成订单"),F=(0,t.Uk)("关闭订单"),C={class:"dialog-content"},k={class:"left-view"},W={class:"right-view"},O={class:"title"},y={class:"title-item"},M={class:"title-item"},U=r((()=>(0,t._)("div",{class:"desc"},"确定完成此订单吗？",-1))),z={class:"dialog-footer"},D=(0,t.Uk)("取消"),V=(0,t.Uk)("确认"),L={class:"dialog-content"},x={class:"left-view"},P={class:"right-view"},B={class:"title"},T={class:"title-item"},S={class:"title-item"},I=r((()=>(0,t._)("div",{class:"desc"},"确定关闭此订单吗？",-1))),N={class:"dialog-footer"},j=(0,t.Uk)("取消"),Y=(0,t.Uk)("确认"),A={class:"dialog-body"},H={class:"list"},$={class:"item-title"},K={class:"item-desc title"},R={class:"left-view"},q={class:"right-view price"},Z={class:"item-desc"},E={class:"left-view type"},J={class:"right-view count"},Q={class:"item-desc company"},G={class:"left-view"},X={class:"right-view unit"},ee=r((()=>(0,t._)("div",{class:"summary-info"},[(0,t._)("div",{class:"left-view"},"合计"),(0,t._)("div",{class:"right-view"},[(0,t._)("div",{class:"right-view-item"},[(0,t._)("div",{class:"label"},"化肥"),(0,t._)("div",{class:"value"},"50000公斤")]),(0,t._)("div",{class:"right-view-item"},[(0,t._)("div",{class:"label"},"有机肥"),(0,t._)("div",{class:"value"},"90000公斤")]),(0,t._)("div",{class:"right-view-item"},[(0,t._)("div",{class:"label"},"参考价"),(0,t._)("div",{class:"value price"},"¥12300.00元")])])],-1))),le=r((()=>(0,t._)("div",{class:"record-div"},[(0,t._)("div",{class:"record-div-title"},"跟进记录"),(0,t._)("div",{class:"record-list"},[(0,t._)("div",{class:"record-item record-item-current"},[(0,t._)("div",{class:"record-item-status"},"订单完成/异常关闭"),(0,t._)("div",{class:"record-item-name"},"张三"),(0,t._)("div",{class:"record-item-time"},"2022.05.25 11:45:25")]),(0,t._)("div",{class:"record-item"},[(0,t._)("div",{class:"record-item-status"},"已经电话沟通，待付款"),(0,t._)("div",{class:"record-item-name"},"张三"),(0,t._)("div",{class:"record-item-time"},"2022.05.25 11:45:25")])])],-1))),ae={class:"dialog-footer"},te=(0,t.Uk)("关闭"),ie={class:"dialog-body"},re={class:"dialog-footer"},se=(0,t.Uk)("取消"),de=(0,t.Uk)("确认");function oe(e,l,a,r,oe,ue){const ce=(0,t.up)("el-input"),ne=(0,t.up)("el-option"),me=(0,t.up)("el-select"),he=(0,t.up)("el-button"),ge=(0,t.up)("el-table-column"),pe=(0,t.up)("el-table"),we=(0,t.up)("el-pagination"),ve=(0,t.up)("el-tab-pane"),be=(0,t.up)("MaterialsTab"),fe=(0,t.up)("el-tabs"),_e=(0,t.up)("WarningFilled"),Fe=(0,t.up)("el-icon"),Ce=(0,t.up)("el-dialog"),ke=(0,t.up)("el-descriptions-item"),We=(0,t.up)("el-descriptions"),Oe=(0,t.up)("el-form-item"),ye=(0,t.up)("el-form"),Me=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",s,[(0,t._)("div",d,["purchaseOrder"===oe.activeName?((0,t.wg)(),(0,t.iD)(t.HY,{key:0},[(0,t.Wm)(ce,{modelValue:oe.purchaseOrderForm.keyWords,"onUpdate:modelValue":l[0]||(l[0]=e=>oe.purchaseOrderForm.keyWords=e),class:"search-input",placeholder:"订单号/提交人/归属企业/农资名称",clearable:""},null,8,["modelValue"]),(0,t._)("div",o,[u,(0,t.Wm)(me,{modelValue:oe.purchaseOrderForm.status,"onUpdate:modelValue":l[1]||(l[1]=e=>oe.purchaseOrderForm.status=e),class:"search-select",placeholder:"请选择"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(oe.orderStatusList,(e=>((0,t.wg)(),(0,t.j4)(ne,{label:e.label,value:e.value,key:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,t.Wm)(he,{type:"primary",onClick:ue.search},{default:(0,t.w5)((()=>[c])),_:1},8,["onClick"])])],64)):((0,t.wg)(),(0,t.iD)(t.HY,{key:1},[(0,t.Wm)(ce,{modelValue:oe.materialsForm.keyWords,"onUpdate:modelValue":l[2]||(l[2]=e=>oe.materialsForm.keyWords=e),class:"search-input",placeholder:"农资ID/农资名称",clearable:""},null,8,["modelValue"]),(0,t._)("div",n,[m,(0,t.Wm)(me,{modelValue:oe.materialsForm.status,"onUpdate:modelValue":l[3]||(l[3]=e=>oe.materialsForm.status=e),class:"search-select",placeholder:"请选择"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(oe.statusList,((e,l)=>((0,t.wg)(),(0,t.j4)(ne,{label:e.label,value:e.value,key:l},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,t.Wm)(he,{type:"primary",onClick:ue.searchMaterials},{default:(0,t.w5)((()=>[h])),_:1},8,["onClick"]),(0,t.Wm)(he,{type:"primary",icon:"CirclePlus",onClick:ue.addMaterials},{default:(0,t.w5)((()=>[g])),_:1},8,["onClick"])])],64))]),(0,t.Wm)(fe,{modelValue:oe.activeName,"onUpdate:modelValue":l[6]||(l[6]=e=>oe.activeName=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(ve,{label:"采购订单",name:"purchaseOrder"},{default:(0,t.w5)((()=>[(0,t.wy)(((0,t.wg)(),(0,t.j4)(pe,{data:oe.purchaseOrderList,style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(ge,{type:"index"}),(0,t.Wm)(ge,{label:"订单号",prop:"orderUuid",width:"180"}),(0,t.Wm)(ge,{label:"订单内容",width:"300"},{default:(0,t.w5)((e=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.agriculturalCartBos,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{class:"order-content-item",key:l},[(0,t._)("div",p,(0,i.zw)(e.agriculturalBo.agriculturalCategory),1),(0,t._)("div",w,(0,i.zw)(e.agriculturalBo.title),1),(0,t._)("div",v,(0,i.zw)(e.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight),1)])))),128))])),_:1}),(0,t.Wm)(ge,{label:"提交时间",width:"180"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,i.zw)(e.row.orderTime),1)])),_:1}),(0,t.Wm)(ge,{label:"提交人",prop:"userName",width:"180"}),(0,t.Wm)(ge,{label:"归属企业",prop:"userCompany",width:"180"}),(0,t.Wm)(ge,{label:"更进状态",prop:"orderStatusText",width:"180"}),(0,t.Wm)(ge,{label:"最新更进",prop:"followText",width:"180"}),(0,t.Wm)(ge,{label:"操作",width:"340"},{default:(0,t.w5)((e=>[(0,t.Wm)(he,{type:"text",size:"small",onClick:l=>ue.openOrderDetailDialog(e.row)},{default:(0,t.w5)((()=>[b])),_:2},1032,["onClick"]),(0,t.Wm)(he,{type:"text",size:"small",onClick:l=>ue.openFollowDialog(e.row)},{default:(0,t.w5)((()=>[f])),_:2},1032,["onClick"]),(0,t.Wm)(he,{type:"text",size:"small",onClick:l=>ue.openFinishOrderDialog(e.row)},{default:(0,t.w5)((()=>[_])),_:2},1032,["onClick"]),(0,t.Wm)(he,{type:"text",size:"small",onClick:l=>ue.openCloseOrderDialog(e.row)},{default:(0,t.w5)((()=>[F])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[Me,oe.loading]]),(0,t.Wm)(we,{class:"pagination",currentPage:oe.purchaseOrderForm.currentPage,"onUpdate:currentPage":l[4]||(l[4]=e=>oe.purchaseOrderForm.currentPage=e),"page-size":oe.purchaseOrderForm.pageSize,"onUpdate:page-size":l[5]||(l[5]=e=>oe.purchaseOrderForm.pageSize=e),"page-sizes":[10,20,30,40],background:"",layout:"total, prev, pager, next, sizes, jumper",total:oe.purchaseOrderForm.total,onSizeChange:ue.handleSizeChange,onCurrentChange:ue.handleCurrentChange},null,8,["currentPage","page-size","total","onSizeChange","onCurrentChange"])])),_:1}),(0,t.Wm)(ve,{label:"农资库",name:"agricultureMaterials"},{default:(0,t.w5)((()=>[(0,t.Wm)(be,{ref:"materialsTab",searchForm:oe.materialsForm},null,8,["searchForm"])])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(Ce,{modelValue:oe.visibleForFinishOrder,"onUpdate:modelValue":l[8]||(l[8]=e=>oe.visibleForFinishOrder=e),title:"完成订单",width:"50%"},{footer:(0,t.w5)((()=>[(0,t._)("span",z,[(0,t.Wm)(he,{onClick:ue.closeFinishOrderDialog},{default:(0,t.w5)((()=>[D])),_:1},8,["onClick"]),(0,t.Wm)(he,{type:"primary",onClick:l[7]||(l[7]=e=>ue.updateOrderStatus(1))},{default:(0,t.w5)((()=>[V])),_:1})])])),default:(0,t.w5)((()=>[(0,t._)("div",C,[(0,t._)("div",k,[(0,t.Wm)(Fe,null,{default:(0,t.w5)((()=>[(0,t.Wm)(_e)])),_:1})]),(0,t._)("div",W,[(0,t._)("div",O,[(0,t._)("span",y,"提交人："+(0,i.zw)(oe.selectedOrder&&oe.selectedOrder.userName),1),(0,t._)("span",M,"归属企业："+(0,i.zw)(oe.selectedOrder&&oe.selectedOrder.userCompany),1)]),U])])])),_:1},8,["modelValue"]),(0,t.Wm)(Ce,{modelValue:oe.visibleForCloseOrder,"onUpdate:modelValue":l[10]||(l[10]=e=>oe.visibleForCloseOrder=e),title:"关闭订单",width:"50%"},{footer:(0,t.w5)((()=>[(0,t._)("span",N,[(0,t.Wm)(he,{onClick:ue.closeCloseOrderDialog},{default:(0,t.w5)((()=>[j])),_:1},8,["onClick"]),(0,t.Wm)(he,{type:"primary",onClick:l[9]||(l[9]=e=>ue.updateOrderStatus(2))},{default:(0,t.w5)((()=>[Y])),_:1})])])),default:(0,t.w5)((()=>[(0,t._)("div",L,[(0,t._)("div",x,[(0,t.Wm)(Fe,null,{default:(0,t.w5)((()=>[(0,t.Wm)(_e)])),_:1})]),(0,t._)("div",P,[(0,t._)("div",B,[(0,t._)("span",T,"提交人："+(0,i.zw)(oe.selectedOrder&&oe.selectedOrder.userName),1),(0,t._)("span",S,"归属企业："+(0,i.zw)(oe.selectedOrder&&oe.selectedOrder.userCompany),1)]),I])])])),_:1},8,["modelValue"]),(0,t.Wm)(Ce,{modelValue:oe.visibleForOrderDetail,"onUpdate:modelValue":l[12]||(l[12]=e=>oe.visibleForOrderDetail=e),title:"订单详情",width:"50%"},{footer:(0,t.w5)((()=>[(0,t._)("span",ae,[(0,t.Wm)(he,{onClick:l[11]||(l[11]=e=>oe.visibleForOrderDetail=!1)},{default:(0,t.w5)((()=>[te])),_:1})])])),default:(0,t.w5)((()=>[(0,t._)("div",A,[(0,t.Wm)(We,{column:2},{default:(0,t.w5)((()=>[(0,t.Wm)(ke,{label:"订单号:"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(oe.selectedOrder&&oe.selectedOrder.orderUuid),1)])),_:1}),(0,t.Wm)(ke,{label:"提交时间:"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(oe.selectedOrder&&oe.selectedOrder.orderTime),1)])),_:1}),(0,t.Wm)(ke,{label:"提交人:"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(oe.selectedOrder&&oe.selectedOrder.userName),1)])),_:1}),(0,t.Wm)(ke,{label:"归属企业："},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(oe.selectedOrder&&oe.selectedOrder.userCompany),1)])),_:1})])),_:1}),(0,t._)("div",H,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(oe.selectedOrder.agriculturalCartBos,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{class:"item",key:l},[(0,t._)("div",$,"农资ID："+(0,i.zw)(e.agriculturalBo.agriculturalNo),1),(0,t._)("div",K,[(0,t._)("div",R,(0,i.zw)(e.agriculturalBo.title),1),(0,t._)("div",q,"¥"+(0,i.zw)(e.agriculturalBo.agriculturalPrice)+"元",1)]),(0,t._)("div",Z,[(0,t._)("div",E,(0,i.zw)(e.agriculturalBo.agriculturalCategory),1),(0,t._)("div",J,(0,i.zw)(e.unit)+"袋（共"+(0,i.zw)(e.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight)+"） ",1)]),(0,t._)("div",Q,[(0,t._)("div",G,(0,i.zw)(e.agriculturalBo.manufacturers),1),(0,t._)("div",X," （"+(0,i.zw)(e.agriculturalBo.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight)+"/"+(0,i.zw)(e.agriculturalBo.unitmeasurement)+"） ",1)])])))),128))]),ee,le])])),_:1},8,["modelValue"]),(0,t.Wm)(Ce,{modelValue:oe.visibleForFollow,"onUpdate:modelValue":l[14]||(l[14]=e=>oe.visibleForFollow=e),title:"订单跟进",width:"50%"},{footer:(0,t.w5)((()=>[(0,t._)("span",re,[(0,t.Wm)(he,{onClick:ue.closeFollowDialog},{default:(0,t.w5)((()=>[se])),_:1},8,["onClick"]),(0,t.Wm)(he,{type:"primary",onClick:ue.saveFollowText},{default:(0,t.w5)((()=>[de])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t._)("div",ie,[(0,t.Wm)(ye,{"label-width":"100px","label-suffix":":",model:oe.followForm},{default:(0,t.w5)((()=>[(0,t.Wm)(Oe,{label:"订单号"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(oe.selectedOrder&&oe.selectedOrder.orderUuid),1)])),_:1}),(0,t.Wm)(Oe,{label:"提交人"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(oe.selectedOrder&&oe.selectedOrder.userName),1)])),_:1}),(0,t.Wm)(Oe,{label:"归属企业"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(oe.selectedOrder&&oe.selectedOrder.userCompany),1)])),_:1}),(0,t.Wm)(Oe,{label:"跟进记录"},{default:(0,t.w5)((()=>[(0,t.Wm)(ce,{modelValue:oe.followForm.followText,"onUpdate:modelValue":l[13]||(l[13]=e=>oe.followForm.followText=e),autosize:{minRows:3,maxRows:5},type:"textarea",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"])])}var ue=a(7484),ce=a.n(ue);const ne={class:"materials-tab-wrapper"},me=(0,t.Uk)("查看详情"),he=(0,t.Uk)("上架"),ge=(0,t.Uk)("下架"),pe=(0,t.Uk)("编辑"),we={class:"dialog-body"},ve=(0,t.Uk)("元 "),be={class:"form-content"},fe=(0,t._)("span",{class:"line"},"/",-1),_e=(0,t.Uk)(" 添加样图 "),Fe=(0,t._)("div",{class:"tips"},"*仅支持jpg和png格式图片上传",-1),Ce={class:"dialog-footer"},ke=(0,t.Uk)("取消"),We=(0,t.Uk)("确认"),Oe={class:"dialog-content"},ye={class:"left-view"},Me=(0,t._)("div",{class:"right-view"},[(0,t._)("div",{class:"title"},[(0,t._)("span",{class:"title-item"},"提交人：13667316666"),(0,t._)("span",{class:"title-item"},"归属企业：湖南xxx农业公司")]),(0,t._)("div",{class:"desc"},"确定取消新建农资吗？")],-1),Ue={class:"dialog-footer"},ze=(0,t.Uk)("取消"),De=(0,t.Uk)("确认"),Ve={class:"dialog-body"},Le={class:"dialog-footer"},xe=(0,t.Uk)("关闭"),Pe={class:"dialog-body"},Be={class:"dialog-footer"},Te=(0,t.Uk)("取消"),Se=(0,t.Uk)("确认");function Ie(e,l,a,r,s,d){const o=(0,t.up)("el-table-column"),u=(0,t.up)("el-button"),c=(0,t.up)("el-table"),n=(0,t.up)("el-pagination"),m=(0,t.up)("el-input"),h=(0,t.up)("el-form-item"),g=(0,t.up)("el-option"),p=(0,t.up)("el-select"),w=(0,t.up)("el-input-number"),v=(0,t.up)("Camera"),b=(0,t.up)("el-icon"),f=(0,t.up)("el-upload"),_=(0,t.up)("el-form"),F=(0,t.up)("el-dialog"),C=(0,t.up)("WarningFilled"),k=(0,t.up)("el-image");return(0,t.wg)(),(0,t.iD)("div",ne,[(0,t.Wm)(c,{data:s.materialsList,style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{type:"index"}),(0,t.Wm)(o,{label:"农资ID",prop:"agriculturalNo",width:"120"}),(0,t.Wm)(o,{label:"农资名称",prop:"title",width:"150"}),(0,t.Wm)(o,{label:"农资类型",width:"120"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,i.zw)(e.row.agriculturalCategory),1)])),_:1}),(0,t.Wm)(o,{label:"参考价值（元）",prop:"agriculturalPrice",width:"150"}),(0,t.Wm)(o,{label:"规格",width:"180"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,i.zw)(e.row.agriculturalCount)+(0,i.zw)(e.row.unitweight)+"/"+(0,i.zw)(e.row.unitmeasurement),1)])),_:1}),(0,t.Wm)(o,{label:"状态",prop:"",width:"180"}),(0,t.Wm)(o,{label:"厂家",prop:"manufacturers",width:"180"}),(0,t.Wm)(o,{label:"操作",width:"300"},{default:(0,t.w5)((e=>[(0,t.Wm)(u,{type:"text",size:"small",onClick:l=>d.viewDetail(e.row)},{default:(0,t.w5)((()=>[me])),_:2},1032,["onClick"]),1===e.row.status?((0,t.wg)(),(0,t.j4)(u,{key:0,type:"text",size:"small",onClick:l=>d.openOperateMaterialsDialog(e.row)},{default:(0,t.w5)((()=>[he])),_:2},1032,["onClick"])):(0,t.kq)("",!0),0===e.row.status?((0,t.wg)(),(0,t.j4)(u,{key:1,type:"text",size:"small",onClick:l=>d.openOperateMaterialsDialog(e.row)},{default:(0,t.w5)((()=>[ge])),_:2},1032,["onClick"])):(0,t.kq)("",!0),(0,t.Wm)(u,{type:"text",size:"small",onClick:l=>d.editMaterials(e.row)},{default:(0,t.w5)((()=>[pe])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,t.Wm)(n,{class:"pagination",currentPage:s.materialsForm.currentPage,"onUpdate:currentPage":l[0]||(l[0]=e=>s.materialsForm.currentPage=e),"page-size":s.materialsForm.pageSize,"onUpdate:page-size":l[1]||(l[1]=e=>s.materialsForm.pageSize=e),"page-sizes":[10,20,30,40],background:"",layout:"total, prev, pager, next, sizes, jumper",total:s.materialsForm.total,onSizeChange:d.handleSizeChange,onCurrentChange:d.handleCurrentChange},null,8,["currentPage","page-size","total","onSizeChange","onCurrentChange"]),(0,t.Wm)(F,{modelValue:s.visibleForAdd,"onUpdate:modelValue":l[11]||(l[11]=e=>s.visibleForAdd=e),title:"新建农资",width:"50%"},{footer:(0,t.w5)((()=>[(0,t._)("span",Ce,[(0,t.Wm)(u,{onClick:d.cancelAdd},{default:(0,t.w5)((()=>[ke])),_:1},8,["onClick"]),(0,t.Wm)(u,{type:"primary",onClick:d.confirmAdd},{default:(0,t.w5)((()=>[We])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t._)("div",we,[(0,t.Wm)(_,{model:s.addForm,"label-width":"120px","label-suffix":":"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{label:"农资名称"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:s.addForm.title,"onUpdate:modelValue":l[2]||(l[2]=e=>s.addForm.title=e),clearable:"",placeholder:"请输入农资名称",maxlength:64,"show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(h,{label:"农资类型"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:s.addForm.agriculturalCategoryId,"onUpdate:modelValue":l[3]||(l[3]=e=>s.addForm.agriculturalCategoryId=e),class:"form-select",placeholder:"选择农资类型"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.materialsTypeList,(e=>((0,t.wg)(),(0,t.j4)(g,{label:e.title,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(h,{label:"参考单价"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:s.addForm.agriculturalPrice,"onUpdate:modelValue":l[4]||(l[4]=e=>s.addForm.agriculturalPrice=e),class:"form-input-number",min:0,precision:2,controls:!1},null,8,["modelValue"]),ve])),_:1}),(0,t.Wm)(h,{label:"规格"},{default:(0,t.w5)((()=>[(0,t._)("div",be,[(0,t.Wm)(w,{modelValue:s.addForm.agriculturalCount,"onUpdate:modelValue":l[5]||(l[5]=e=>s.addForm.agriculturalCount=e),min:0,precision:2,controls:!1},null,8,["modelValue"]),(0,t.Wm)(p,{modelValue:s.addForm.unitweightid,"onUpdate:modelValue":l[6]||(l[6]=e=>s.addForm.unitweightid=e),placeholder:"请选择"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.unitTypeList,(e=>((0,t.wg)(),(0,t.j4)(g,{label:e.title,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),fe,(0,t.Wm)(p,{modelValue:s.addForm.unitmeasurementid,"onUpdate:modelValue":l[7]||(l[7]=e=>s.addForm.unitmeasurementid=e),placeholder:"请选择"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.unitmeasurementList,(e=>((0,t.wg)(),(0,t.j4)(g,{label:e.title,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),_:1}),(0,t.Wm)(h,{label:"厂家"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:s.addForm.manufacturers,"onUpdate:modelValue":l[8]||(l[8]=e=>s.addForm.manufacturers=e),placeholder:"请输入厂家",maxlength:64,"show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(h,{label:"农资banner图"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{"file-list":s.addForm.bannerList,"onUpdate:file-list":l[9]||(l[9]=e=>s.addForm.bannerList=e),action:s.uploadApi,"list-type":"picture-card","on-preview":d.handlePictureCardPreview,"on-remove":d.handleRemove},{tip:(0,t.w5)((()=>[Fe])),default:(0,t.w5)((()=>[(0,t.Wm)(b,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1}),_e])),_:1},8,["file-list","action","on-preview","on-remove"])])),_:1}),(0,t.Wm)(h,{label:"农资图文介绍"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:s.addForm.richContent,"onUpdate:modelValue":l[10]||(l[10]=e=>s.addForm.richContent=e),autosize:{minRows:3,maxRows:5},type:"textarea",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"]),(0,t.Wm)(F,{modelValue:s.visibleForCancel,"onUpdate:modelValue":l[13]||(l[13]=e=>s.visibleForCancel=e),title:"提示",width:"40%"},{footer:(0,t.w5)((()=>[(0,t._)("span",Ue,[(0,t.Wm)(u,{onClick:l[12]||(l[12]=e=>s.visibleForCancel=!1)},{default:(0,t.w5)((()=>[ze])),_:1}),(0,t.Wm)(u,{type:"primary",onClick:d.confirm},{default:(0,t.w5)((()=>[De])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t._)("div",Oe,[(0,t._)("div",ye,[(0,t.Wm)(b,null,{default:(0,t.w5)((()=>[(0,t.Wm)(C)])),_:1})]),Me])])),_:1},8,["modelValue"]),(0,t.Wm)(F,{modelValue:s.visibleForDetail,"onUpdate:modelValue":l[15]||(l[15]=e=>s.visibleForDetail=e),title:"农资详情",width:"50%"},{footer:(0,t.w5)((()=>[(0,t._)("span",Le,[(0,t.Wm)(u,{onClick:d.closeDetailDialog},{default:(0,t.w5)((()=>[xe])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t._)("div",Ve,[(0,t.Wm)(_,{model:s.addForm,"label-width":"120px","label-suffix":":"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{label:"农资名称"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalBo.title),1)])),_:1}),(0,t.Wm)(h,{label:"农资类型"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalBo.agriculturalCategory),1)])),_:1}),(0,t.Wm)(h,{label:"参考单价"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalBo.agriculturalPrice)+"元 ",1)])),_:1}),(0,t.Wm)(h,{label:"规格"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalBo.agriculturalCount)+(0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalBo.unitweight)+"/"+(0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalBo.unitmeasurement),1)])),_:1}),(0,t.Wm)(h,{label:"厂家"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalBo.manufacturers),1)])),_:1}),(0,t.Wm)(h,{label:"农资banner图"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.selectedMaterials.imgList,(e=>((0,t.wg)(),(0,t.j4)(k,{class:"banner",src:e,fit:"cover",key:e},null,8,["src"])))),128))])),_:1}),(0,t.Wm)(h,{label:"农资图文介绍"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:s.selectedMaterials.richContent,"onUpdate:modelValue":l[14]||(l[14]=e=>s.selectedMaterials.richContent=e),autosize:{minRows:3,maxRows:5},type:"textarea",placeholder:"请输入",readonly:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"]),(0,t.Wm)(F,{modelValue:s.visibleForOperate,"onUpdate:modelValue":l[16]||(l[16]=e=>s.visibleForOperate=e),title:"农资上/下架",width:"40%"},{footer:(0,t.w5)((()=>[(0,t._)("span",Be,[(0,t.Wm)(u,{onClick:d.closeOperateMaterialsDialog},{default:(0,t.w5)((()=>[Te])),_:1},8,["onClick"]),(0,t.Wm)(u,{type:"primary",onClick:d.updateMaterialsStatus},{default:(0,t.w5)((()=>[Se])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t._)("div",Pe,[(0,t.Wm)(_,{"label-width":"120px","label-suffix":":"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{label:"农资ID"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalNo),1)])),_:1}),(0,t.Wm)(h,{label:"农资名称"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.title),1)])),_:1}),(0,t.Wm)(h,{label:"参考单价"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalPrice)+"元 ",1)])),_:1}),(0,t.Wm)(h,{label:"规格"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(s.selectedMaterials&&s.selectedMaterials.agriculturalCount)+(0,i.zw)(s.selectedMaterials&&s.selectedMaterials.unitweight)+"/"+(0,i.zw)(s.selectedMaterials&&s.selectedMaterials.unitmeasurement),1)])),_:1})])),_:1})])])),_:1},8,["modelValue"])])}var Ne=a(512),je={name:"MaterialsTab",props:{searchForm:{type:Object,default:()=>{}}},data(){return{uploadApi:Ne.aq,materialsTypeList:[],unitTypeList:[],unitmeasurementList:[],materialsList:[],statusList:[{label:"全部",value:-1},{label:"上架",value:0},{label:"下架",value:1}],materialsForm:{keyWords:"",status:-1,currentPage:1,pageSize:10,total:0},visibleForAdd:!1,addForm:{id:0,agriculturalId:0,title:"",agriculturalCategoryId:"",agriculturalPrice:void 0,agriculturalCount:void 0,unitweightid:"",unitmeasurementid:"",manufacturers:"",bannerList:"",richContent:""},visibleForCancel:!1,visibleForDetail:!1,visibleForOperate:!1,selectedMaterials:null}},watch:{searchForm:{handler(e){this.materialsForm.keyWords=e.keyWords,this.materialsForm.status=e.status},immediate:!0,deep:!0}},mounted(){this.getMaterialTypeList(),this.getUnitTypeList(),this.getUnitmeasurementList(),this.getMaterialsList()},methods:{getMaterialTypeList(){const e={};return(0,Ne.gF)(e).then((e=>{e&&e.data&&(this.materialsTypeList=e.data)}))},getUnitTypeList(){const e={};return(0,Ne.tn)(e).then((e=>{e&&e.data&&(this.unitTypeList=e.data)}))},getUnitmeasurementList(){const e={};(0,Ne.t6)(e).then((e=>{e&&e.data&&(this.unitmeasurementList=e.data)}))},getMaterialsList(){const e={pageNum:this.materialsForm.currentPage,pageSize:this.materialsForm.pageSize,param:{id:0,keyWord:this.materialsForm.keyWords,status:this.materialsForm.status}};return(0,Ne.lR)(e).then((e=>{this.materialsForm.total=e.total||0,e&&e.data?this.materialsList=e.data.map((e=>e)):this.materialsList=[]}))},getMaterialsDetail(e){const l={id:e};return(0,Ne.T_)(l).then((e=>{e&&e.data?(this.selectedMaterials=e.data,this.selectedMaterials.bannerList&&(this.selectedMaterials.imgList=this.selectedMaterials.bannerList.split(","))):this.selectedMaterials=null}))},saveMaterials(){const e={id:this.addForm.id,agriculturalBo:{agriculturalCategory:"",agriculturalCategoryId:this.addForm.agriculturalCategoryId,agriculturalCount:this.addForm.agriculturalCount,agriculturalNo:"",agriculturalPrice:this.addForm.agriculturalPrice,definition:0,id:this.addForm.agriculturalId,manufacturers:this.addForm.manufacturers,title:this.addForm.title,unitmeasurement:"",unitmeasurementid:this.addForm.unitmeasurementid,unitweight:"",unitweightid:this.addForm.unitweightid,weight:0},bannerList:"",richContent:this.addForm.richContent},l=this.materialsTypeList.find((e=>e.id===this.addForm.agriculturalCategoryId)),a=this.unitTypeList.find((e=>e.id===this.addForm.unitweightid)),t=this.unitmeasurementList.find((e=>e.id===this.addForm.unitmeasurementid));if(e.agriculturalCategory=l&&l.title,e.unitmeasurement=t&&t.title,e.unitweight=a&&a.title,this.addForm.bannerList&&this.addForm.bannerList.length>0){const l=[];this.addForm.bannerList.forEach((e=>{e.response&&e.response.data&&l.push(e.response.data.imageUrl)})),e.bannerList=l.join(",")}return(0,Ne.BD)(e).then((e=>{e&&"200"===e.code?(this.$message.success("操作成功"),this.getMaterialsList()):this.$message.error(e.message||"操作失败")}))},updateMaterialsStatus(){const e={id:this.selectedMaterials.id,keyWord:"",status:0===this.selectedMaterials.status?1:0};return(0,Ne.uL)(e).then((e=>{e&&"200"===e.code?(this.$message.success("操作成功"),this.getMaterialsList()):this.$message.error(e.message||"操作失败")}))},handleSizeChange(){this.materialsForm.currentPage=1,this.getMaterialsList()},handleCurrentChange(){this.getMaterialsList()},handlePictureCardPreview(){},handleRemove(){},cancelAdd(){this.visibleForCancel=!0},confirmAdd(){this.saveMaterials(),this.visibleForCancel=!1,this.visibleForAdd=!1,this.addForm={id:0,agriculturalId:0,title:"",agriculturalCategoryId:"",agriculturalPrice:void 0,agriculturalCount:void 0,unitweightid:"",unitmeasurementid:"",manufacturers:"",bannerList:"",richContent:""}},confirm(){this.visibleForCancel=!1,this.visibleForAdd=!1,this.addForm={id:0,agriculturalId:0,title:"",agriculturalCategoryId:"",agriculturalPrice:void 0,agriculturalCount:void 0,unitweightid:"",unitmeasurementid:"",manufacturers:"",bannerList:"",richContent:""}},addMaterials(){this.visibleForAdd=!0},editMaterials(e){this.getMaterialsDetail(e.id).then((()=>{this.addForm={id:e.id,agriculturalId:this.selectedMaterials.agriculturalBo.id,title:this.selectedMaterials.agriculturalBo.title,agriculturalCategoryId:this.selectedMaterials.agriculturalBo.agriculturalCategoryId,agriculturalPrice:this.selectedMaterials.agriculturalBo.agriculturalPrice,agriculturalCount:this.selectedMaterials.agriculturalBo.agriculturalCount,unitweightid:this.selectedMaterials.agriculturalBo.unitweightid,unitmeasurementid:this.selectedMaterials.agriculturalBo.title,manufacturers:this.selectedMaterials.agriculturalBo.manufacturers,bannerList:"",richContent:this.selectedMaterials.richContent},this.selectedMaterials.bannerList&&(this.addForm.bannerList=this.selectedMaterials.bannerList.split(",").map((e=>({url:e,response:{data:{imageUrl:e}}})))),this.visibleForAdd=!0}))},openOperateMaterialsDialog(e){this.selectedMaterials=e,this.visibleForOperate=!0},closeOperateMaterialsDialog(){this.visibleForOperate=!1,this.selectedMaterials=null},viewDetail(e){this.getMaterialsDetail(e.id).then((()=>{this.visibleForDetail=!0}))},closeDetailDialog(){this.visibleForDetail=!1}}},Ye=a(3744);const Ae=(0,Ye.Z)(je,[["render",Ie]]);var He=Ae,$e={name:"IndexPage",components:{MaterialsTab:He},data(){return{activeName:"purchaseOrder",loading:!1,purchaseOrderList:[],orderStatusList:[{label:"全部",value:-1},{label:"未跟进",value:0},{label:"已完成",value:1},{label:"已关闭",value:2},{label:"已跟进",value:3}],statusList:[{label:"全部",value:-1},{label:"上架",value:0},{label:"下架",value:1}],purchaseOrderForm:{keyWords:"",status:-1,currentPage:1,pageSize:10,total:0},selectedOrder:null,visibleForFinishOrder:!1,visibleForCloseOrder:!1,visibleForOrderDetail:!1,visibleForFollow:!1,followForm:{followText:""},materialsForm:{keyWords:"",status:""}}},mounted(){this.getPurchaseOrderList()},methods:{getPurchaseOrderList(){const e={pageNum:this.purchaseOrderForm.currentPage,pageSize:this.purchaseOrderForm.pageSize,param:{id:0,keyWord:this.purchaseOrderForm.keyWords,orderState:this.purchaseOrderForm.status}};return this.loading=!0,(0,Ne.aK)(e).then((e=>{this.loading=!1,this.purchaseOrderForm.total=e.total||0,e&&e.data?this.purchaseOrderList=e.data.map((e=>{const l=this.orderStatusList.find((l=>l.value===e.orderStatus));return e.orderStatusText=l&&l.label||"",e})):this.purchaseOrderList=[]}))},handleSizeChange(){this.purchaseOrderForm.currentPage=1,this.getPurchaseOrderList()},handleCurrentChange(){this.getPurchaseOrderList()},search(){this.purchaseOrderForm.currentPage=1,this.getPurchaseOrderList()},updateOrderStatus(e){const l={id:this.selectedOrder.id,orderStatus:e};return(0,Ne.hJ)(l).then((l=>{l&&"200"===l.code?(this.$message.success("操作成功"),1===e?this.closeFinishOrderDialog():2===e&&this.closeCloseOrderDialog(),this.getPurchaseOrderList()):this.$message.error(l.message||"操作失败")}))},openFinishOrderDialog(e){this.selectedOrder=e,this.visibleForFinishOrder=!0},closeFinishOrderDialog(){this.visibleForFinishOrder=!1,this.selectedOrder=null},openCloseOrderDialog(e){this.selectedOrder=e,this.visibleForCloseOrder=!0},closeCloseOrderDialog(){this.visibleForCloseOrder=!1,this.selectedOrder=null},openOrderDetailDialog(e){this.selectedOrder=e,this.visibleForOrderDetail=!0},closeOrderDetailDialog(){this.visibleForOrderDetail=!1,this.selectedOrder=null},openFollowDialog(e){this.selectedOrder=e,this.visibleForFollow=!0},closeFollowDialog(){this.visibleForFollow=!1,this.selectedOrder=null},saveFollowText(){const e={createTime:ce()().format("YYYY-MM-DD HH:mm:ss"),followText:this.followForm.followText,id:this.selectedOrder&&this.selectedOrder.id,orderNo:this.selectedOrder&&this.selectedOrder.orderUuid};return(0,Ne.BD)(e).then((e=>{e&&"200"===e.code?(this.$message.success("操作成功"),this.closeFollowDialog(),this.getPurchaseOrderList()):this.$message.error(e.message||"操作失败")}))},addMaterials(){this.$refs.materialsTab.addMaterials()},searchMaterials(){this.$refs.materialsTab.getMaterialsList()}}};const Ke=(0,Ye.Z)($e,[["render",oe],["__scopeId","data-v-913300be"]]);var Re=Ke}}]);
//# sourceMappingURL=709.614a7ee1.js.map