"use strict";(self["webpackChunkerp"]=self["webpackChunkerp"]||[]).push([[232],{974:function(e,t,l){l.r(t),l.d(t,{default:function(){return we}});var a=l(6252),i=l(3577);const s=e=>((0,a.dD)("data-v-35ae56cc"),e=e(),(0,a.Cn)(),e),o={class:"index-wrapper"},d={class:"search-wrapper"},n={class:"search-item"},r=s((()=>(0,a._)("div",{class:"search-item-lable"},"模型状态",-1))),c=(0,a.Uk)("搜索"),u=(0,a.Uk)("创建模型"),p=(0,a.Uk)("查看详情"),m=(0,a.Uk)("停用"),g=(0,a.Uk)("启用"),h=(0,a.Uk)("编辑"),w={class:"pagination-div"},v={class:"dialog-content"},M={class:"left-view"},_={class:"right-view"},f={class:"title"},k={class:"title-item"},b={class:"title-item"},P={class:"title-item"},D={class:"desc"},S={class:"dialog-footer"},y=(0,a.Uk)("取消"),C=(0,a.Uk)("确认");function L(e,t,l,s,L,W){const z=(0,a.up)("el-input"),F=(0,a.up)("el-option"),N=(0,a.up)("el-select"),U=(0,a.up)("el-button"),V=(0,a.up)("el-table-column"),T=(0,a.up)("el-table"),I=(0,a.up)("el-pagination"),x=(0,a.up)("el-tab-pane"),A=(0,a.up)("el-tabs"),G=(0,a.up)("WarningFilled"),Y=(0,a.up)("el-icon"),H=(0,a.up)("el-dialog"),K=(0,a.up)("PlantModelDetail");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",d,[(0,a.Wm)(z,{modelValue:L.plantModelForm.keyWords,"onUpdate:modelValue":t[0]||(t[0]=e=>L.plantModelForm.keyWords=e),class:"search-input",placeholder:"请输入作物种类/作物品种"},null,8,["modelValue"]),(0,a._)("div",n,[r,(0,a.Wm)(N,{modelValue:L.plantModelForm.status,"onUpdate:modelValue":t[1]||(t[1]=e=>L.plantModelForm.status=e),class:"search-select",placeholder:"请选择"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(L.statusList,(e=>((0,a.wg)(),(0,a.j4)(F,{label:e.label,value:e.value,key:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,a.Wm)(U,{type:"primary",onClick:W.search},{default:(0,a.w5)((()=>[c])),_:1},8,["onClick"]),(0,a.Wm)(U,{type:"primary",icon:"CirclePlus",onClick:W.addPlantModel},{default:(0,a.w5)((()=>[u])),_:1},8,["onClick"])])]),(0,a.Wm)(A,{modelValue:L.activeName,"onUpdate:modelValue":t[4]||(t[4]=e=>L.activeName=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"植物模型列表",name:"plantModelTab"},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{data:L.plantModelList,style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(V,{type:"index",fixed:"left"}),(0,a.Wm)(V,{label:"植物种类",prop:"categoryTitle",width:"120",fixed:"left"}),(0,a.Wm)(V,{label:"植物品种",prop:"varietyTitle",width:"150"}),(0,a.Wm)(V,{label:"栽培方式",width:"120"},{default:(0,a.w5)((e=>[(0,a.Uk)((0,i.zw)(e.row.growthName),1)])),_:1}),(0,a.Wm)(V,{label:"模型状态",prop:"stateText",width:"120"},{default:(0,a.w5)((e=>[(0,a._)("span",{class:(0,i.C_)(W.getStatusClassName(e.row.state))},(0,i.zw)(e.row.stateText),3)])),_:1}),(0,a.Wm)(V,{label:"创建人",prop:"createName",width:"180"}),(0,a.Wm)(V,{label:"操作时间",prop:"updateTime",width:"180"}),(0,a.Wm)(V,{label:"操作",width:"200",fixed:"right"},{default:(0,a.w5)((e=>[(0,a.Wm)(U,{link:"",type:"primary",size:"small",onClick:t=>W.openDetailDialog(e.row)},{default:(0,a.w5)((()=>[p])),_:2},1032,["onClick"]),0===e.row.state?((0,a.wg)(),(0,a.j4)(U,{key:0,link:"",type:"primary",size:"small",onClick:t=>W.openStopAndStartDialog(e.row)},{default:(0,a.w5)((()=>[m])),_:2},1032,["onClick"])):(0,a.kq)("",!0),1===e.row.state?((0,a.wg)(),(0,a.j4)(U,{key:1,link:"",type:"primary",size:"small",onClick:t=>W.openStopAndStartDialog(e.row)},{default:(0,a.w5)((()=>[g])),_:2},1032,["onClick"])):(0,a.kq)("",!0),(0,a.Wm)(U,{link:"",type:"primary",size:"small",onClick:t=>W.editPlantModel(e.row)},{default:(0,a.w5)((()=>[h])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,a._)("div",w,[(0,a.Wm)(I,{class:"pagination",currentPage:L.plantModelForm.currentPage,"onUpdate:currentPage":t[2]||(t[2]=e=>L.plantModelForm.currentPage=e),"page-size":L.plantModelForm.pageSize,"onUpdate:page-size":t[3]||(t[3]=e=>L.plantModelForm.pageSize=e),"page-sizes":[10,20,30,40],background:"",layout:"total, prev, pager, next, sizes, jumper",total:L.plantModelForm.total,onSizeChange:W.handleSizeChange,onCurrentChange:W.handleCurrentChange},null,8,["currentPage","page-size","total","onSizeChange","onCurrentChange"])])])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(H,{modelValue:L.visibleForStopAndStart,"onUpdate:modelValue":t[5]||(t[5]=e=>L.visibleForStopAndStart=e),title:L.selectedPlantModel&&0===L.selectedPlantModel.state?"停用":"启用",width:"40%"},{footer:(0,a.w5)((()=>[(0,a._)("span",S,[(0,a.Wm)(U,{onClick:W.closeStopAndStartDialog},{default:(0,a.w5)((()=>[y])),_:1},8,["onClick"]),(0,a.Wm)(U,{type:"primary",onClick:W.stopAndStartPlantModel},{default:(0,a.w5)((()=>[C])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a._)("div",v,[(0,a._)("div",M,[(0,a.Wm)(Y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(G)])),_:1})]),(0,a._)("div",_,[(0,a._)("div",f,[(0,a._)("span",k,"植物种类："+(0,i.zw)(L.selectedPlantModel&&L.selectedPlantModel.categoryTitle),1),(0,a._)("span",b,"植物品种："+(0,i.zw)(L.selectedPlantModel&&L.selectedPlantModel.varietyTitle),1),(0,a._)("span",P,"栽培方式："+(0,i.zw)(L.selectedPlantModel&&L.selectedPlantModel.growthName),1)]),(0,a._)("div",D," 确定"+(0,i.zw)(L.selectedPlantModel&&0===L.selectedPlantModel.state?"停用":"启用")+"此模型吗？ ",1)])])])),_:1},8,["modelValue","title"]),(0,a.Wm)(K,{isShow:L.isShowDetailDialog,plantModelId:L.selectedPlantModel&&L.selectedPlantModel.id,onClose:W.closeDetailDialog},null,8,["isShow","plantModelId","onClose"])])}var W=l(7484),z=l.n(W),F=l(512);const N={class:"plant-model-detail-wrapper"},U={class:"content"},V={class:"section"},T=(0,a._)("div",{class:"section-title"},[(0,a._)("div",{class:"left-view"},[(0,a.Uk)(" 植物生长模型 "),(0,a._)("span",{class:"tips"},"模型支持左右移动")])],-1),I={class:"card-list"},x={class:"card-header"},A={class:"card-header-title"},G={class:"left-view"},Y={class:"card-header-img"},H={class:"card-table"},K=(0,a._)("div",{class:"card-table-row"},[(0,a._)("div",{class:"left-view"},"参数名"),(0,a._)("div",{class:"right-view"},"参数值")],-1),j={class:"left-view"},$={class:"right-view"},q={class:"section"},B=(0,a._)("div",{class:"section-title"},[(0,a._)("div",{class:"left-view"},[(0,a.Uk)(" 种植参考建议 "),(0,a._)("span",{class:"tips"},"模型支持上下移动")])],-1),Z={key:0,class:"icon-low"},E={key:1,class:"icon-high"},Q={class:"section"},X=(0,a._)("div",{class:"section-title"},[(0,a._)("div",{class:"left-view"},"农事操作指导")],-1),J={class:"guide-list"},O=["src"],R={class:"title"},ee={class:"desc-div"},te={class:"section"},le=(0,a._)("div",{class:"section-title"},[(0,a._)("div",{class:"left-view"},"病虫害防治")],-1),ae={class:"guide-list"},ie=["src"],se={class:"title"},oe={class:"desc-div"},de={class:"dialog-footer"},ne=(0,a.Uk)("关闭");function re(e,t,l,s,o,d){const n=(0,a.up)("el-form-item"),r=(0,a.up)("el-form"),c=(0,a.up)("el-image"),u=(0,a.up)("el-table-column"),p=(0,a.up)("el-table"),m=(0,a.up)("el-button"),g=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)("div",N,[(0,a.Wm)(g,{modelValue:o.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>o.visible=e),title:"种植模型详情",width:"50%","close-on-click-modal":!1,onClose:d.closeDialog},{footer:(0,a.w5)((()=>[(0,a._)("span",de,[(0,a.Wm)(m,{onClick:d.closeDialog},{default:(0,a.w5)((()=>[ne])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a._)("div",U,[(0,a.Wm)(r,{ref:"form",inline:!0,"label-suffix":"：",class:"form"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{label:"种植类型"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(o.detailInfo.categoryTitle),1)])),_:1}),(0,a.Wm)(n,{label:"种植品种"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(o.detailInfo.varietyTitle),1)])),_:1}),(0,a.Wm)(n,{label:"培育方式"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(o.detailInfo.growthName),1)])),_:1})])),_:1},512),(0,a._)("div",V,[T,(0,a._)("div",I,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.growthStageList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"card-item",key:t},[(0,a._)("div",x,[(0,a._)("div",A,[(0,a._)("div",G,"阶段"+(0,i.zw)(t+1)+"："+(0,i.zw)(e.phaseName),1)]),(0,a._)("div",Y,[(0,a.Wm)(c,{class:"img",src:e.image,fit:"cover"},null,8,["src"])])]),(0,a._)("div",H,[K,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.growPlantModelDetailBos,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"card-table-row",key:t},[(0,a._)("div",j,(0,i.zw)(e.parameterName),1),(0,a._)("div",$,(0,i.zw)(e.leastValue)+"-"+(0,i.zw)(e.maxValue)+(0,i.zw)(e.unit),1)])))),128))])])))),128))])]),(0,a._)("div",q,[B,(0,a.Wm)(p,{class:"section-table",data:d.tableData,"max-height":"500","cell-class-name":d.getCellClassName},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.standardList,((e,t)=>((0,a.wg)(),(0,a.j4)(u,{key:t,label:e.parameterName,width:"120"},{default:(0,a.w5)((t=>[(0,a._)("span",null,(0,i.zw)(d.getStatusText(t.row[e.parameterName])),1),0===t.row[e.parameterName]?((0,a.wg)(),(0,a.iD)("span",Z)):(0,a.kq)("",!0),2===t.row[e.parameterName]?((0,a.wg)(),(0,a.iD)("span",E)):(0,a.kq)("",!0)])),_:2},1032,["label"])))),128)),(0,a.Wm)(u,{label:"种植建议",prop:"text"})])),_:1},8,["data","cell-class-name"])]),(0,a._)("div",Q,[X,(0,a._)("div",J,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.farmGuideList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"guide-item",key:t},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.imgList,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"guide-item-img",key:e.url},[d.isVideo(e.url)?((0,a.wg)(),(0,a.iD)("video",{key:0,class:"video",src:e.url,controls:""},null,8,O)):((0,a.wg)(),(0,a.j4)(c,{key:1,class:"img",src:e.url,fit:"cover"},null,8,["src"]))])))),128)),(0,a._)("div",R,(0,i.zw)(e.title),1),(0,a._)("div",ee,(0,i.zw)(e.text),1)])))),128))])]),(0,a._)("div",te,[le,(0,a._)("div",ae,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.cureGuideList,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"guide-item",key:t},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.imgList,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"guide-item-img",key:e.url},[d.isVideo(e.url)?((0,a.wg)(),(0,a.iD)("video",{key:0,class:"video",src:e.url,controls:""},null,8,ie)):((0,a.wg)(),(0,a.j4)(c,{key:1,class:"img",src:e.url,fit:"cover"},null,8,["src"]))])))),128)),(0,a._)("div",se,(0,i.zw)(e.title),1),(0,a._)("div",oe,(0,i.zw)(e.text),1)])))),128))])])])])),_:1},8,["modelValue","onClose"])])}var ce={name:"PlantModelDetail",props:{isShow:{type:Boolean,default:!1},plantModelId:{type:Number,default:0}},data(){return{visible:!1,detailInfo:{},growthStageList:[],standardList:[],tableList:[],farmGuideList:[],cureGuideList:[]}},computed:{tableData(){let e=[];return this.tableList.forEach((t=>{t.growPlantAdviseDetailBos&&t.growPlantAdviseDetailBos.forEach((e=>{t[e.parameterName]=e.status})),e.push(t)})),e}},watch:{isShow(e){this.visible=e,e&&this.plantModelId&&(this.getPlantModelDetail(),this.getGrowthStageList().then((()=>{this.getStandardList()})),this.getPlantSuggestionList(),this.getFarmGuideList(),this.getCureGuideList())}},methods:{getPlantModelDetail(){const e={id:this.plantModelId};return(0,F.oQ)(e).then((e=>{e&&e.data&&(this.detailInfo=e.data)}))},getGrowthStageList(){const e={id:this.plantModelId};return(0,F.bA)(e).then((e=>{e&&e.data&&(this.growthStageList=e.data)}))},getPlantSuggestionList(){const e={id:this.plantModelId};return(0,F.FK)(e).then((e=>{e&&e.data&&(this.tableList=e.data)}))},getFarmGuideList(){const e={id:this.plantModelId};return(0,F.Ly)(e).then((e=>{e&&e.data&&(this.farmGuideList=e.data.map((e=>(e.imgList=[{url:e.video,response:{data:{imageUrl:e.video}}}],e))))}))},getCureGuideList(){const e={id:this.plantModelId};return(0,F.w7)(e).then((e=>{e&&e.data&&(this.cureGuideList=e.data.map((e=>(e.imgList=[{url:e.video,response:{data:{imageUrl:e.video}}}],e))))}))},getStandardList(){if(0===this.growthStageList.length)return;const e={growPlantId:this.growthStageList.map((e=>e.id)).join(",")};return(0,F.nX)(e).then((e=>{e&&e.data?this.standardList=e.data.map((e=>({parameterName:e.title,status:1}))):this.$message.error(e.message||"获取参数列表失败")}))},closeDialog(){this.$emit("close")},getStatusText(e){const t=[{label:"偏低",value:0},{label:"正常",value:1},{label:"偏高",value:2}],l=t.find((t=>t.value===e));return l?l.label:e},getCellClassName({row:e,column:t}){const l=t.label,a=e[l],i={0:"cell-low",1:"cell-normal",2:"cell-high"};return i[a]||""},isVideo(e){const t=/.(mp4|MP4|3gp|3GP)$/;return t.test(e)}}},ue=l(3744);const pe=(0,ue.Z)(ce,[["render",re]]);var me=pe,ge={name:"PlantModel",components:{PlantModelDetail:me},data(){return{activeName:"plantModelTab",loading:!1,statusList:[{label:"全部",value:-1},{label:"正常",value:0},{label:"已停用",value:1}],plantModelList:[],plantModelForm:{keyWords:"",status:-1,currentPage:1,pageSize:10,total:0},visibleForStopAndStart:!1,selectedPlantModel:null,isShowDetailDialog:!1}},mounted(){this.getPlantModelList()},methods:{getPlantModelList(){const e={pageNum:this.plantModelForm.currentPage,pageSize:this.plantModelForm.pageSize,param:{id:0,keyWord:this.plantModelForm.keyWords,state:this.plantModelForm.status}};return this.loading=!0,(0,F.GZ)(e).then((e=>{this.loading=!1,this.plantModelForm.total=e.total||0,e&&e.data?this.plantModelList=e.data.map((e=>{const t=this.statusList.find((t=>t.value===e.state));return e.stateText=t&&t.label,e})):this.plantModelList=[]}))},stopAndStartPlantModel(){const e={categoryTitle:this.selectedPlantModel.categoryTitle,createName:this.selectedPlantModel.createName,growthId:this.selectedPlantModel.growthId,growthName:this.selectedPlantModel.growthName,id:this.selectedPlantModel.id,state:0===this.selectedPlantModel.state?1:0,updateTime:z()().format("YYYY-MM-DD HH:mm:ss"),varietyTitle:this.selectedPlantModel.varietyTitle};return(0,F.$w)(e).then((e=>{e&&"200"===e.code?(this.$message.success("操作成功"),this.closeStopAndStartDialog(),this.getPlantModelList()):this.$message.error(e.message||"操作失败")}))},handleSizeChange(){this.plantModelForm.currentPage=1,this.getPlantModelList()},handleCurrentChange(){this.getPlantModelList()},openStopAndStartDialog(e){this.selectedPlantModel=e,this.visibleForStopAndStart=!0},closeStopAndStartDialog(){this.visibleForStopAndStart=!1,this.selectedPlantModel=null},addPlantModel(){this.$router.push("/add")},search(){this.getPlantModelList()},editPlantModel(e){this.$router.push({path:"/add",query:{id:e.id}})},openDetailDialog(e){this.selectedPlantModel=e,this.isShowDetailDialog=!0},closeDetailDialog(){this.isShowDetailDialog=!1,this.selectedPlantModel=null},getStatusClassName(e){const t={0:"status-start",1:"status-stop"};return t[e]||""}}};const he=(0,ue.Z)(ge,[["render",L],["__scopeId","data-v-35ae56cc"]]);var we=he}}]);
//# sourceMappingURL=232.4192040e.js.map